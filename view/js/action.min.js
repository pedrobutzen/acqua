function log(e){console.log(e)}function logar(){var e=$("input[name=usuario]").val();var t=$("input[name=senha]").val();if(e===""&&t===""){alert_open("danger","Todos os campos são obrigatórios.")}else if(e===""){alert_open("danger","Digite o usuário.")}else if(t===""){alert_open("danger","Digite a senha.")}else{$.ajax({type:"GET",url:"action/action_outros.php",dataType:"json",data:{action_pagina:"usuario",action:"logar",usuario_logar_usuario:e,usuario_logar_senha:t},success:function(e){if(e.erro===false){location.href=caminho}else{alert_open("danger",e.msg_erro)}},error:function(){alert_open("danger","Erro inesperando, tente novamente mais tarde.")}})}}function deslogar(){$.ajax({type:"GET",url:"action/action_outros.php",dataType:"json",data:{action_pagina:"usuario",action:"deslogar"},success:function(e){if(e.erro===false){location.href=caminho+"login"}else{alert_open("danger",e.msg_erro)}},error:function(){alert_open("danger","Erro inesperando, tente novamente mais tarde.")}})}function carregar_select(e){$.ajax({type:"GET",url:"action/action_listar.php",dataType:"json",data:{action_pagina:e,action:"listarselect"},success:function(t){var n='<option value="">Selecione</option>';if(t.erro===false){switch(e){case"peca":for(var r=1;r<t[0].qtd_geral+1;r++){n+='<option value="'+t[r].idtipo+'">'+t[r].nome+"</option>"}n+='<option value="outro">Outro</option>';break;case"ocorrencia":for(var r=1;r<t[0].qtd_geral+1;r++){n+='<option value="'+t[r].idtipo_ocorrencia+'">'+t[r].tipo+"</option>"}break;default:break}}$("select").html(n)}})}function listar(e,t,n){limpar_form_cadastro();$.ajax({type:"GET",url:"action/action_listar.php",dataType:"json",data:{action_pagina:e,action:"listar",listar_pag:t,listar_qtd_itens:n,action_id:action_id_local},success:function(r){var i="";if(r.erro===false){var s=0;$.each(r,function(){s++});switch(e){case"peca":carregar_select(e);$("div.cs-legenda").html("");for(var o=1;o<s-1;o++){if(r[o].hasocorrencia==="1"){$("div.cs-legenda").html('<span class="gray">*Peça com ocorrência ativa registrada</span>');i+='<tr class="gray" data-id="'+r[o].idpeca+'" data-pagina="peca" title="Clique para detalhar peça"><td>'+r[o].descricao+"</td><td>"+r[o].nometipo+"</td><td>"+r[o].marca+"</td><td>"+r[o].cor+"</td><td>"+r[o].tamanho+"</td><td>"+r[o].tipoocorrencia+"</td></tr>"}else{i+='<tr data-id="'+r[o].idpeca+'" data-pagina="peca" title="Clique para detalhar peça"><td>'+r[o].descricao+"</td><td>"+r[o].nometipo+"</td><td>"+r[o].marca+"</td><td>"+r[o].cor+"</td><td>"+r[o].tamanho+"</td><td>Normal</td></tr>"}}break;case"gerenciarocorrencia":$("div.cs-legenda").html("");for(var o=1;o<s-1;o++){if(r[o].ocorrenciastatus==="1"){$("div.cs-legenda").html('<span class="gray">*Peça com ocorrência ativa registrada</span>');i+='<tr class="gray" data-id="'+r[o].idpeca+'" data-pagina="gerenciarocorrencia" title="Clique para detalhar peça"><td>'+r[o].descricao+"</td><td>"+r[o].nometipo+"</td><td>"+r[o].marca+"</td><td>"+r[o].cor+"</td><td>"+r[o].ocorrenciadescricao+"</td><td>"+r[o].tipoocorrencia+"</td></tr>"}else{i+='<tr data-id="'+r[o].idpeca+'" data-pagina="gerenciarocorrencia" title="Clique para detalhar peça"><td>'+r[o].descricao+"</td><td>"+r[o].nometipo+"</td><td>"+r[o].marca+"</td><td>"+r[o].cor+"</td><td>"+r[o].ocorrenciadescricao+"</td><td>"+r[o].tipoocorrencia+"</td></tr>"}}break;case"cadastrarocorrencia":$("div.cs-legenda").html("");for(var o=1;o<s-1;o++){i+='<tr data-id="'+r[o].idpeca+'" data-pagina="cadastrarocorrencia" title="Clique para detalhar peça"><td>'+r[o].descricao+"</td><td>"+r[o].nometipo+"</td><td>"+r[o].marca+"</td><td>"+r[o].cor+"</td><td>"+r[o].tamanho+"</td></tr>"}break;case"ocorrencia":$("div.cs-legenda").html("");for(var o=1;o<s-1;o++){if(r[o].ocorrenciastatus==="1"){$("div.cs-legenda").html('<span class="gray">*Peça com ocorrência ativa registrada</span>');i+='<tr class="gray" data-id="'+r[o].idpeca+'" data-pagina="ocorrencia" title="Clique para detalhar peça"><td>'+r[o].descricao+"</td><td>"+r[o].nometipo+"</td><td>"+r[o].marca+"</td><td>"+r[o].cor+"</td><td>"+r[o].ocorrenciadescricao+"</td><td>"+r[o].tipoocorrencia+"</td></tr>"}else{i+='<tr data-id="'+r[o].idpeca+'" data-pagina="ocorrencia" title="Clique para detalhar peça"><td>'+r[o].descricao+"</td><td>"+r[o].nometipo+"</td><td>"+r[o].marca+"</td><td>"+r[o].cor+"</td><td>"+r[o].ocorrenciadescricao+"</td><td>"+r[o].tipoocorrencia+"</td></tr>"}}break;case"entradapeca":$("div.cs-legenda").html("");$("span#botao-rigth").html('<button type="button" class="btn btn-primary cs-entradapecalancamento-info" >Confirmar Entrada</button>');for(var o=1;o<s-1;o++){i+='<tr data-id="'+r[o].idpeca+'" data-pagina="entradapeca" title="Clique para detalhar peça"><td>'+r[o].descricao+"</td><td>"+r[o].nometipo+"</td><td>"+r[o].marca+"</td><td>"+r[o].cor+"</td><td>"+r[o].tamanho+"</td></tr>"}$("button.cs-entradapecalancamento-info").click(function(){modal_info("Deseja realmente confirmar a entrada das peças da lista?","Não será mais possível editar nem remover peças deste lancamento.",'<button type="button" class="btn btn-primary cs-entradapecalancamento">Confirmar</button>');$("button.cs-entradapecalancamento").click(function(){$.ajax({type:"GET",url:"action/action_outros.php",dataType:"json",data:{action_pagina:"entradapeca",action:"confirmarentrada"},success:function(e){if(e.erro===false){alert_open("success","Entrada de lançamento confirmada com sucesso.");$("#cs-dataGrid").html("");$("#botao-rigth").html("");$("#cs-modal").modal("hide")}else{alert_open("danger",e.msg_erro)}},error:function(){alert_open("danger","Erro inesperando, tente novamente mais tarde.")}})})});break;case"saidapeca":$("div.cs-legenda").html("");$("span#botao-rigth").html('<button type="button" class="btn btn-primary cs-saidapecalancamento-info" >Confirmar Devolução</button>');for(var o=1;o<s-1;o++){i+='<tr data-id="'+r[o].idpeca+'" data-pagina="saidapeca" title="Clique para detalhar peça"><td>'+r[o].descricao+"</td><td>"+r[o].nometipo+"</td><td>"+r[o].marca+"</td><td>"+r[o].cor+"</td><td>"+r[o].tamanho+"</td></tr>"}$("button.cs-saidapecalancamento-info").click(function(){modal_info("Deseja realmente confirmar a devolução das peças da lista?","Confira se todas as peças da lista estão sendo devolvidas e de acordo com a descrição.",'<button type="button" class="btn btn-primary cs-saidapecalancamento">Confirmar</button>');$("button.cs-saidapecalancamento").click(function(){$.ajax({type:"GET",url:"action/action_outros.php",dataType:"json",data:{action_pagina:"saidapeca",action:"confirmarsaida"},success:function(e){if(e.erro===false){alert_open("success","Devolução confirmada com sucesso.");$("#cs-dataGrid").html("");$("#botao-rigth").html("");$("#cs-modal").modal("hide")}else{alert_open("danger",e.msg_erro)}},error:function(){alert_open("danger","Erro inesperando, tente novamente mais tarde.")}})})});break;case"lancamentoativo":for(var o=1;o<s-1;o++){i+="<tr><td>"+r[o].descricao+"</td><td>"+r[o].nometipo+"</td><td>"+r[o].marca+"</td><td>"+r[o].cor+"</td><td>"+r[o].tamanho+"</td></tr>"}break;case"lancamentospassados":for(var o=1;o<s-1;o++){i+='<tr data-id="'+r[o].idlancamento+'" data-pagina="lancamentospassados" title="Clique para visualizar peças do lançamento"><td>'+r[o].data_criacao+"</td><td>"+r[o].data_recebimento+"</td><td>"+r[o].usuario_recebimento+"</td><td>"+r[o].data_devolucao+"</td><td>"+r[o].usuario_devolucao+"</td></tr>"}break;case"visualizarlancamentousuario":for(var o=1;o<s-1;o++){i+='<tr data-id="'+r[o].idlancamento+'" data-pagina="visualizarlancamentousuario" title="Clique para visualizar peças do lançamento"><td>'+r[o].data_criacao+"</td><td>"+r[o].usuario+"</td><td>"+r[o].data_recebimento+"</td><td>"+r[o].usuario_recebimento+"</td><td>"+r[o].data_devolucao+"</td><td>"+r[o].usuario_devolucao+"</td></tr>"}break;case"tipoocorrencia":for(var o=1;o<s-1;o++){i+='<tr data-id="'+r[o].idtipo_ocorrencia+'" data-pagina="tipoocorrencia" title="Clique para visualizar o tipo"><td>'+r[o].tipo+"</td></tr>"}break;case"usuario-funcionario":$("input[name=pesquisa]").val(action_id_local);$("#cs-thead-dataGrid").html("<tr><th>Nome</th><th>Usuário</th><th>Telefone/Contato</th></tr>");for(var o=1;o<s-1;o++){var u="";switch(r[o].permissao){case"1":u="danger";break;case"2":u="warning";break;default:break}i+='<tr class="'+u+'" data-id="'+r[o].usuario+'" data-pagina="usuario-funcionario" title="Clique para detalhar usuário"><td>'+r[o].nome+"</td><td>"+r[o].usuario+"</td><td>"+r[o].ramal+"</td></tr>"}$("div.cs-legenda").html('<span class="label-danger">Total</span> - <span class="label-warning">Visualização Relatórios</span>');break;case"usuario-aluno":$("input[name=pesquisa]").val(action_id_local);$("#cs-thead-dataGrid").html("<tr><th>Nome</th><th>Usuário</th><th>Ramal</th><th>Quarto</th></tr>");$("div.cs-legenda").html("");$("div.cs-legenda").html('<span class="label-danger">Aluno bloqueado</span> <span class="gray">Aluno sem número</span>');for(var o=1;o<s-1;o++){if(r[o].bloqueado===""||r[o].bloqueado==="0"){if(r[o].num===""){i+='<tr class="gray" data-id="'+r[o].usuario+'" data-pagina="usuario-aluno" title="Clique para detalhar usuário"><td>'+r[o].nome+"</td><td>"+r[o].usuario+"</td><td>"+r[o].ramal+"</td><td>"+r[o].quarto+"</td></tr>"}else{i+='<tr data-id="'+r[o].usuario+'" data-pagina="usuario-aluno" title="Clique para detalhar usuário"><td>'+r[o].nome+"</td><td>"+r[o].usuario+"</td><td>"+r[o].ramal+"</td><td>"+r[o].quarto+"</td></tr>"}}else{i+='<tr class="danger" data-id="'+r[o].usuario+'" data-pagina="usuario-aluno" title="Clique para detalhar usuário"><td>'+r[o].nome+"</td><td>"+r[o].usuario+"</td><td>"+r[o].ramal+"</td><td>"+r[o].quarto+"</td></tr>"}}break;case"numero_feminino":$("div.cs-legenda").html("");$("div.cs-legenda").html('<span class="label-success">Número disponível</span>');for(var o=1;o<s-1;o++){if(r[o].nome_usuario===""){i+='<tr class="success"><td>'+r[o].num+"</td><td>Disponível</td></tr>"}else{i+="<tr><td>"+r[o].num+"</td><td>"+r[o].nome_usuario+"</td></tr>"}}break;case"numero_masculino":$("div.cs-legenda").html("");$("div.cs-legenda").html('<span class="label-success">Número disponível</span>');for(var o=1;o<s-1;o++){if(r[o].nome_usuario===""){i+='<tr class="success"><td>'+r[o].num+"</td><td>Disponível</td></tr>"}else{i+="<tr><td>"+r[o].num+"</td><td>"+r[o].nome_usuario+"</td></tr>"}}break;default:break}$("button.cs-editar").click(function(){switch($(this).attr("data-action")){case"editar_peca":editar_peca();break;case"editar_tipoocorrencia":editar_tipoocorrencia();break;case"editar_usuario":editar_usuario_funcionario();$("div#senhas").show();break;default:break}});$("#cs-dataGrid").html(i);paginar(e,t,n,r[0].qtd_geral);$("ul#cs-pagination a").click(function(){listar($(this).attr("data-pagina"),$(this).attr("data-paginacao"),$(this).attr("data-qtd-itens"))});$(".cs-with-modal tr").click(function(){var e;switch($(this).attr("data-pagina")){case"peca":e="Detalhes de Peça";break;case"entradapeca":tr_clicada=$(this);e="Detalhes de Peça";break;case"saidapeca":tr_clicada=$(this);e="Detalhes de Peça";break;case"cadastrarocorrencia":e="Detalhes de Peça";break;case"ocorrencia":e="Detalhes de Peça com Ocorrência";break;case"tipoocorrencia":e="Detalhes do Tipo de Ocorrência";break;case"gerenciarocorrencia":e="Detalhes de Peça com Ocorrência";break;case"lancamentospassados":e="Detalhes do Lançamento";break;case"visualizarlancamentousuario":e="Detalhes do Lançamento";break;case"usuario-aluno":e="Detalhes do Aluno";break;case"usuario-funcionario":e="Detalhes do Funcionário";break;default:e="Página não identificada";break}modal_open($(this).attr("data-id"),$(this).attr("data-pagina"),e);$("ul.dropdown-menu a#pre_editar").click(function(){pre_editar($(this).attr("data-pagina"),$(this).attr("data-id"))})})}else{$("input[name=pesquisa]").val(action_id_local);$("#cs-dataGrid").html("");alert_open("danger",r.msg_erro)}},error:function(){$("#cs-dataGrid").html("");alert_open("danger","Impossível listar "+e)}})}function limpar_form_cadastro(){$("input").val("");$("select").val("");$("button.cs-cancelar").hide();$("button.cs-editar").hide();$("button.cs-salvar").show();$("panel-body.cs-id-editar span").html("")}function pre_editar(e,t){$("div#cs-alert-danger").hide();$("div#cs-alert-success").hide();$("button.cs-pre-cadastrar").show();$.ajax({type:"GET",url:"action/action_montar.php",dataType:"json",data:{action_pagina:e,action:"montar",action_id:t},success:function(t){$("span#cs-action").text("Editar");$("button.cs-salvar").hide();$("button.cs-editar").show();$("button.cs-cancelar").show();if(t.erro===false){switch(e){case"usuario-funcionario":$("div.cs-id-editar").html('<input type="text" name="id-editar" class="form-control" style="display:none;">');$("div#senhas").hide();$("input[name=usuario_nome]").val(t[0].nome);$("input[name=id-editar]").val(t[0].usuario);$("input[name=usuario_usuario]").val(t[0].usuario);$("input[name=email]").val(t[0].email);$("input[name=usuario_telefone]").val(t[0].ramal);$("select[name=usuario_sexo]").val(t[0].sexo);$("select[name=usuario_permissao]").val(t[0].permissao);break;case"peca":$("div.cs-id-editar").html('<input type="text" name="id-editar" class="form-control" style="display:none;">');$("input[name=descricao]").val(t[0].descricaopeca);$("input[name=id-editar]").val(t[0].idpeca);$("input[name=marca]").val(t[0].marca);$("input[name=cor]").val(t[0].cor);$("input[name=tamanho]").val(t[0].tamanho);$("select[name=tipo]").val(t[0].idtipo);break;case"tipoocorrencia":$("div.cs-id-editar").html('<input type="text" name="id-editar" class="form-control" style="display:none;">');$("input[name=tipo]").val(t[0].tipo);$("input[name=id-editar]").val(t[0].idtipo_ocorrencia);break;default:break}}else{alert_open("danger",t.msg_erro)}},error:function(){alert_open("danger","Erro inesperando, tente novamente mais tarde.")}})}function excluir(e,t){$.ajax({type:"GET",url:"action/action_excluir.php",dataType:"json",data:{action_pagina:e,action:"excluir",action_id:t},success:function(t){if(e==="entradapeca"){listar(e,1,15)}else{listar(e,1,10)}if(t.erro==="success"){alert_open("success",t.msg_status)}else if(t.erro===false){alert_open("success","Excluído com sucesso.")}else{alert_open("danger",t.msg_erro)}},error:function(){alert_open("danger","Erro inesperando, tente novamente mais tarde.")}})}function paginar(e,t,n,r){t=parseInt(t);if(r>n){$("#cs-pagination-content").html('<ul class="pagination" id="cs-pagination"></ul>');if(t!==1){$("#cs-pagination").append('<li><a href="javascript:;" data-pagina="'+e+'" data-paginacao="1" data-qtd-itens="'+n+'">«</a></li>');$("#cs-pagination").append('<li><a href="javascript:;" data-pagina="'+e+'" data-paginacao="'+(t-1)+'" data-qtd-itens="'+n+'">‹</a></li>')}var i=Math.ceil(r/n);$("#cs-pagination").append('<li class="active"><span>'+t+" de "+i+'<span class="sr-only">(current)</span></span></li>');if(t!==i){$("#cs-pagination").append('<li><a href="javascript:;" data-pagina="'+e+'" data-paginacao="'+(t+1)+'" data-qtd-itens="'+n+'">›</a></li>');$("#cs-pagination").append('<li><a href="javascript:;" data-pagina="'+e+'" data-paginacao="'+i+'" data-qtd-itens="'+n+'">»</a></li>')}}else{$("#cs-pagination-content").html("")}}function alert_open(e,t){alert_close("all");if(e==="danger"){$("div#cs-alert-danger span").text(t);$("div#cs-alert-danger").fadeIn()}else if(e==="success"){$("div#cs-alert-success span").text(t);$("div#cs-alert-success").fadeIn()}setTimeout(function(){alert_close("all")},1e4)}function alert_close(e){if(e==="danger"){$("div#cs-alert-danger").hide()}else if(e==="success"){$("div#cs-alert-success").hide()}else if(e==="all"){$("div#cs-alert-danger").hide();$("div#cs-alert-success").hide()}}function modal_info(e,t,n){$(".modal-title").html(e);$(".modal-body").html(t);$(".modal-footer").html(n+'<button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>');$("#cs-modal").modal("show")}function modal_open(e,t,n){var r=n;$.ajax({type:"GET",url:"action/action_montar.php",dataType:"json",data:{action_pagina:t,action:"montar",action_id:e},success:function(i){if(i.erro===false){var s,o;var u='<button type="button" class="btn btn-default cs-voltar">Voltar</button>';var a='<button type="button" data-id="'+e+'" data-pagina="'+t+'" class="btn btn-primary cs-editar">Editar</button>';var f='<button type="button" data-id="'+e+'" data-pagina="'+t+'" class="btn btn-primary cs-excluir-info">Excluir</button>';var l=Array();l["f"]="Feminino";l["m"]="Masculino";if(t==="usuario-aluno"||t==="usuario-funcionario"){var c;var h='<button type="button" data-id="'+e+'" data-pagina="usuario-aluno" class="btn btn-primary cs-conf-alterar-num">Alterar Num</button>';var p='<button type="button" data-id="'+e+'" data-pagina="usuario-aluno" class="btn btn-primary cs-conf-alterar-num">Atribuir Num</button>';var d='<button type="button" data-id="'+e+'" class="btn btn-primary cs-desbloquear">Desbloquear</button>';var v='<button type="button" data-id="'+e+'" class="btn btn-primary cs-bloquear">Bloquear</button>';switch(i[0].permissao){case"1":c="Total";break;case"2":c="Visualização Relatórios";break;default:c="Permissão não identificada";break}switch(t){case"usuario-funcionario":s='<ul class="list-unstyled" id="cs-list-modal">';s+="<li><strong>Nome:</strong>"+i[0].nome+"</li>";s+="<li><strong>Usuário:</strong>"+i[0].usuario+"</li>";s+="<li><strong>Email:</strong>"+i[0].email+"</li>";s+="<li><strong>Sexo:</strong>"+l[i[0].sexo]+"</li>";s+="<li><strong>Telefone/Contato:</strong>"+i[0].ramal+"</li>";s+="<li><strong>Permissão:</strong>"+c+"</li>";s+="</ul>";o=a+f;break;case"usuario-aluno":s='<ul class="list-unstyled" id="cs-list-modal">';s+="<li><strong>Nome:</strong>"+i[0].nome+"</li>";s+="<li><strong>Usuário:</strong>"+i[0].usuario+"</li>";s+="<li><strong>Email:</strong>"+i[0].email+"</li>";s+="<li><strong>Sexo:</strong>"+l[i[0].sexo]+"</li>";if(i[0].num===""){s+='<li class="gray"><strong>Número:</strong><span id="cs-num-aluno">Aluno sem número</span></li>'}else{s+='<li><strong>Número:</strong><span id="cs-num-aluno">'+i[0].num+"</span></li>"}s+="<li><strong>Ramal:</strong>"+i[0].ramal+"</li>";s+="<li><strong>Quarto:</strong>"+i[0].quarto+"</li>";if(i[0].bloqueado==="1"){s+="<li><strong>Status:</strong>Bloqueado</li>"}else{s+="<li><strong>Status:</strong>Desbloqueado</li>"}s+="</ul>";if(i[0].bloqueios.qtd_bloqueios>0){s+='<br><div class="table-responsive"><div class="text-center">Bloqueios</div><table class="table table-condensed"><thead><tr><th>Data Início</th><th>Data Fim</th><th>Usuário Bloqueio</th><th>Usuário Desbloqueio</th></tr></thead><tbody>';for(var m=0;m<i[0].bloqueios.qtd_bloqueios;m++){s+="<tr><td>"+i[0].bloqueios[m].data_inicio+"</td><td>"+i[0].bloqueios[m].data_fim+"</td><td>"+i[0].bloqueios[m].usuario_bloqueio+"</td><td>"+i[0].bloqueios[m].usuario_desbloqueio+"</td></tr>"}s+="</tbody></table></div>"}o="";if(i[0].num===""){o+=p}else{o+=h}if(i[0].bloqueado===""||i[0].bloqueado==="0"){o+=v}else{o+=d}break;default:break}}else if(t==="peca"){s='<ul class="list-unstyled" id="cs-list-modal">';s+="<li><strong>Descrição:</strong>"+i[0].descricaopeca+"</li>";s+="<li><strong>Marca:</strong>"+i[0].marca+"</li>";s+="<li><strong>Cor:</strong>"+i[0].cor+"</li>";s+="<li><strong>Tamanho:</strong>"+i[0].tamanho+"</li>";s+="<li><strong>Tipo:</strong>"+i[0].nometipo+"</li>";s+="</ul>";if(i[0].ocorrencia.qtd_ocorrencias>0){var g=Array();g["0"]="Finalizada";g["1"]="Ativa";s+='<br><div class="table-responsive"><div class="text-center">Ocorrências</div><table class="table table-condensed"><thead><tr><th>Descrição</th><th>Tipo</th><th>Status</th></tr></thead><tbody>';for(var m=0;m<i[0].ocorrencia.qtd_ocorrencias;m++){s+="<tr><td>"+i[0].ocorrencia[m].descricao+"</td><td>"+i[0].ocorrencia[m].tipoocorrenca+"</td><td>"+g[i[0].ocorrencia[m].status]+"</td></tr>"}s+="</tbody></table></div>"}o=a+f}else if(t==="ocorrencia"||t==="gerenciarocorrencia"){s='<ul class="list-unstyled" id="cs-list-modal">';s+="<li><strong>Usuário:</strong>"+i[0].usuario+"</li>";s+="<li><strong>Descrição:</strong>"+i[0].descricaopeca+"</li>";s+="<li><strong>Marca:</strong>"+i[0].marca+"</li>";s+="<li><strong>Cor:</strong>"+i[0].cor+"</li>";s+="<li><strong>Tamanho:</strong>"+i[0].tamanho+"</li>";s+="<li><strong>Tipo:</strong>"+i[0].nometipo+"</li>";s+="</ul>";if(i[0].ocorrencia.qtd_ocorrencias>0){var g=Array();g["0"]="Finalizada";g["1"]="Ativa";if(t==="ocorrencia"){s+='<br><div class="table-responsive"><div class="text-center">Ocorrências</div><table class="table table-condensed"><thead><tr><th>Descrição</th><th>Tipo</th><th>Status</th></tr></thead><tbody>'}else{s+='<br><div class="table-responsive"><div class="text-center">Ocorrências</div><table class="table table-condensed"><thead><tr><th>Descrição</th><th>Tipo</th><th>Status</th><th>Usuário Criação</th><th>Usuário Finalizou</th><th>Opção</th></tr></thead><tbody>'}for(var m=0;m<i[0].ocorrencia.qtd_ocorrencias;m++){if(t==="ocorrencia"){s+="<tr><td>"+i[0].ocorrencia[m].descricao+"</td><td>"+i[0].ocorrencia[m].tipoocorrencia+"</td><td>"+g[i[0].ocorrencia[m].status]+"</td></tr>"}else{var y="";if(i[0].ocorrencia[m].status==="1"){y='<button type="button" data-id="'+i[0].ocorrencia[m].idocorrencia+'" class="btn btn-primary cs-finalizar-ocorrencia-info">Finalizar</button>'}s+="<tr><td>"+i[0].ocorrencia[m].descricao+"</td><td>"+i[0].ocorrencia[m].tipoocorrencia+"</td><td>"+g[i[0].ocorrencia[m].status]+"</td><td>"+i[0].ocorrencia[m].usuario_criacao+"</td><td>"+i[0].ocorrencia[m].usuario_finalizou+"</td><td>"+y+"</td></tr>"}}s+="</tbody></table></div>"}o=""}else if(t==="lancamentospassados"||t==="visualizarlancamentousuario"){s='<ul class="list-unstyled" id="cs-list-modal">';s+="<li><strong>Data Criação:</strong>"+i[0].data_criacao+"</li>";s+="<li><strong>Usuário Aluno:</strong>"+i[0].usuario+"</li>";s+="<li><strong>Data Recebimento:</strong>"+i[0].data_recebimento+"</li>";s+="<li><strong>Usuário que Recebeu:</strong>"+i[0].usuario_recebimento+"</li>";s+="<li><strong>Data Devolução:</strong>"+i[0].data_devolucao+"</li>";s+="<li><strong>Usuário que Devolveu:</strong>"+i[0].usuario_devolucao+"</li>";s+="</ul>";if(i[0].pecas[0].qtd_pecas>0){s+='<br><div class="table-responsive"><div class="text-center">Peças</div><table class="table table-condensed"><thead><tr><th>Descrição</th><th>Marca</th><th>Cor</th><th>Tamanho</th><th>Tipo</th></tr></thead><tbody>';for(var m=1;m<=i[0].pecas[0].qtd_pecas;m++){s+="<tr><td>"+i[0].pecas[m].descricao+"</td><td>"+i[0].pecas[m].marca+"</td><td>"+i[0].pecas[m].cor+"</td><td>"+i[0].pecas[m].tamanho+"</td><td>"+i[0].pecas[m].nometipo+"</td></tr>"}s+="</tbody></table></div>"}o=""}else if(t==="usuarioentradapeca"||t==="usuariosaidapeca"||t==="usuariovisualizarlancamento"||t==="usuariogerenciarocorrencia"||t==="usuariocadastrarocorrencia"){o="";s='<ul class="list-unstyled" id="cs-list-modal">';s+="<li><strong>Nome:</strong>"+i[0].nome+"</li>";s+="<li><strong>Usuário:</strong>"+i[0].usuario+"</li>";s+="<li><strong>Email:</strong>"+i[0].email+"</li>";s+="<li><strong>Sexo:</strong>"+l[i[0].sexo]+"</li>";if(i[0].num===""){s+='<li class="gray"><strong>Número:</strong><span id="cs-num-aluno">Aluno sem número</span></li>'}else{s+='<li><strong>Número:</strong><span id="cs-num-aluno">'+i[0].num+"</span></li>"}s+="<li><strong>Ramal:</strong>"+i[0].ramal+"</li>";s+="<li><strong>Quarto:</strong>"+i[0].quarto+"</li>";if(i[0].bloqueado==="1"){s+="<li><strong>Status:</strong>Bloqueado</li>"}else{s+="<li><strong>Status:</strong>Desbloqueado</li>"}switch(t){case"usuarioentradapeca":if(i[0].lancamentoativo===0){s+="<br><li><strong>Status do Lançamento:</strong>Aluno não criou um lançamento</li>"}else if(i[0].lancamentoativo===-1){s+="<br><li><strong>Status do Lançamento:</strong>Aluno já possui peças na lavanderia</li>"}else{o='<button type="button" data-id="'+e+'" class="btn btn-primary cs-receber-peca">Receber Peça</button>'}action_id_local=i[0].lancamentoativo;break;case"usuariosaidapeca":if(i[0].lancamentoativo===0){s+="<br><li><strong>Status do Lançamento:</strong>Aluno não criou um lançamento</li>"}else if(i[0].lancamentoativo===-1){s+="<br><li><strong>Status do Lançamento:</strong>Aluno criou lançamento, porém não troxe as peças para lavanderia</li>"}else{o='<button type="button" data-id="'+e+'" class="btn btn-primary cs-devolver-peca">Devolver Peça</button>'}action_id_local=i[0].lancamentoativo;break;case"usuariovisualizarlancamento":o+='<button type="button" class="btn btn-primary cs-conf-usuario-lancamento">Confirmar Usuário</button>';action_id_local=i[0].usuario;break;case"usuariogerenciarocorrencia":o+='<button type="button" class="btn btn-primary cs-conf-usuario-ocorrencia">Confirmar Usuário</button>';action_id_local=i[0].usuario;break;case"usuariocadastrarocorrencia":o+='<button type="button" class="btn btn-primary cs-conf-usuario-cadastrar-ocorrencia">Confirmar Usuário</button>';action_id_local=i[0].usuario;break;default:break}s+="</ul>";if(i[0].num===""){o+='<button type="button" data-id="'+e+'" class="btn btn-primary cs-conf-alterar-num">Atribuir Num</button>'}else{o+='<button type="button" data-id="'+e+'" class="btn btn-primary cs-conf-alterar-num">Alterar Num</button>'}if(i[0].bloqueado===""||i[0].bloqueado==="0"){o+='<button type="button" data-id="'+e+'" class="btn btn-primary cs-bloquear">Bloquear</button>'}else{o+='<button type="button" data-id="'+e+'" class="btn btn-primary cs-desbloquear">Desbloquear</button>'}}else if(t==="entradapeca"||t==="saidapeca"){s='<ul class="list-unstyled" id="cs-list-modal">';s+="<li><strong>Descrição:</strong>"+i[0].descricaopeca+"</li>";s+="<li><strong>Marca:</strong>"+i[0].marca+"</li>";s+="<li><strong>Cor:</strong>"+i[0].cor+"</li>";s+="<li><strong>Tamanho:</strong>"+i[0].tamanho+"</li>";s+="<li><strong>Tipo:</strong>"+i[0].nometipo+"</li>";s+="</ul>";if($(tr_clicada).hasClass("cs-tr-blue")){o='<button type="button" class="btn btn-primary cs-desconferir-peca">Desconferir</button>'}else{o='<button type="button" class="btn btn-primary cs-conferir-peca">Conferir</button>'}if(t==="entradapeca"){o+='<button type="button" data-id="'+e+'" data-pagina="'+t+'" class="btn btn-primary cs-editar-peca-lancamento-info">Editar</button>'+'<button type="button" data-id-lancamento="'+action_id_local+'" data-id="'+e+'" data-pagina="'+t+'" class="btn btn-primary cs-excluir-info">Excluir do Lançamento</button>'}else{o+='<button type="button" data-id="'+e+'" data-pagina="'+t+'" class="btn btn-primary cs-cadastrarocorrencia-lancamento-info">Nova Ocorrência</button>'}}else if(t==="cadastrarocorrencia"){s='<ul class="list-unstyled" id="cs-list-modal">';s+="<li><strong>Usuário:</strong>"+i[0].usuario+"</li>";s+="<li><strong>Descrição:</strong>"+i[0].descricaopeca+"</li>";s+="<li><strong>Marca:</strong>"+i[0].marca+"</li>";s+="<li><strong>Cor:</strong>"+i[0].cor+"</li>";s+="<li><strong>Tamanho:</strong>"+i[0].tamanho+"</li>";s+="<li><strong>Tipo:</strong>"+i[0].nometipo+"</li>";s+="</ul>";if(i[0].ocorrencia.qtd_ocorrencias>0){var g=Array();g["0"]="Finalizada";g["1"]="Ativa";if(t==="ocorrencia"){s+='<br><div class="table-responsive"><div class="text-center">Ocorrências</div><table class="table table-condensed"><thead><tr><th>Descrição</th><th>Tipo</th><th>Status</th></tr></thead><tbody>'}else{s+='<br><div class="table-responsive"><div class="text-center">Ocorrências</div><table class="table table-condensed"><thead><tr><th>Descrição</th><th>Tipo</th><th>Status</th><th>Usuário Criação</th><th>Usuário Finalizou</th></tr></thead><tbody>'}for(var m=0;m<i[0].ocorrencia.qtd_ocorrencias;m++){s+="<tr><td>"+i[0].ocorrencia[m].descricao+"</td><td>"+i[0].ocorrencia[m].tipoocorrencia+"</td><td>"+g[i[0].ocorrencia[m].status]+"</td><td>"+i[0].ocorrencia[m].usuario_criacao+"</td><td>"+i[0].ocorrencia[m].usuario_finalizou+"</td></tr>"}s+="</tbody></table></div>"}o='<button type="button" data-id="'+e+'" data-pagina="'+t+'" class="btn btn-primary cs-cadastrarocorrencia-lancamento-info">Nova Ocorrência</button>'}else if(t==="tipoocorrencia"){s='<ul class="list-unstyled" id="cs-list-modal">';s+="<li><strong>Tipo:</strong>"+i[0].tipo+"</li>";s+="</ul>";o=a+f}$(".modal-title").html(n);$(".modal-body").html(s);$(".modal-footer").html(o+'<button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>');$("#cs-modal").modal("show");$("button.cs-finalizar-ocorrencia-info").click(function(){modal_info("Deseja realmente finalizar a ocorrência?","Não será mais possível ativa-la novamente.",'<button type="button" data-id="'+$(this).attr("data-id")+'" class="btn btn-primary cs-finalizar-ocorrencia">Finalizar</button>');$("button.cs-finalizar-ocorrencia").click(function(){$.ajax({type:"GET",url:"action/action_outros.php",dataType:"json",data:{action_pagina:"gerenciarocorrencia",action:"finalizar",action_id:$(this).attr("data-id")},success:function(e){if(e.erro===false){alert_open("success","Ocorrência finalizada com sucesso.");listar("gerenciarocorrencia",1,10);$("#cs-modal").modal("hide")}else{alert_open("danger",e.msg_erro)}},error:function(){alert_open("danger","Erro inesperando, tente novamente mais tarde.")}})})});$("#cs-modal .cs-conferir-peca").click(function(){$(tr_clicada).addClass("cs-tr-blue");$("#cs-modal").modal("hide")});$("#cs-modal .cs-desconferir-peca").click(function(){$(tr_clicada).removeClass("cs-tr-blue");$("#cs-modal").modal("hide")});$("#cs-modal .cs-cadastrarocorrencia-lancamento-info").click(function(){modal_info("Cadastrar ocorrência ligada a peça selecionada",'<form class="form-horizontal" role="form"><div class="form-group"><label for="inputdescricao" class="col-sm-2 control-label">Descrição</label><div class="col-sm-10"><input type="text" name="descricao" class="form-control" id="inputdescricao" placeholder="Descrição"></div></div><div class="form-group"><label for="selectTipo" class="col-sm-2 control-label">Tipo</label><div class="col-sm-10"><select name="selectTipo" id="selectTipo" class="form-control"></select></div></div></form>','<button type="button" data-id="'+e+'" class="btn btn-primary cs-cadastrarocorrencia-lancamento">Cadastrar Ocorrência</button>');carregar_select("ocorrencia");$("#cs-modal .cs-cadastrarocorrencia-lancamento").click(function(){var t=$("input[name=descricao]").val();var n=$("select[name=selectTipo]").find(":selected").val();if(t===""||n===""){alert_open("danger","Todos campos são obrigatórios.")}else{$.ajax({type:"GET",url:"action/action_cadastrar.php",dataType:"json",data:{action_pagina:"ocorrencia",action:"cadastrar",descricao:t,idtipo_ocorrencia:n,idpeca:e},success:function(e){if(e.erro===false){alert_open("success","Ocorrência cadastrada com sucesso.");$("#cs-modal").modal("hide")}else{alert_open("danger",e.msg_erro)}}})}})});$("button.cs-editar-peca-lancamento-info").click(function(){pre_editar("peca",$(this).attr("data-id"));$("span#cs-div-pesquisa").hide();$("span#cs-div-editar").show();$("button.cs-cancelar-editar-lancamento").click(function(){$("span#cs-div-pesquisa").show();$("span#cs-div-editar").hide()});$("button.cs-editar-lancamento").click(function(){$.ajax({type:"GET",url:"action/action_outros.php",dataType:"json",data:{action_pagina:"entradapeca",action:"pegarlogado"},success:function(r){if(r.erro===false){if(r.status===0){n="Digite a senha para autorização - Aluno";s='<form class="form-horizontal" role="form"><div class="form-group"><label class="col-sm-2 control-label">RA</label><div class="col-sm-10"><p class="form-control-static">'+r.usuario+'</p></div></div><div class="form-group"><label for="inputPassword" class="col-sm-2 control-label">Senha</label><div class="col-sm-10"><input type="password" name="senha" class="form-control" id="inputPassword" placeholder="Senha"></div></div></form>';o='<button type="button" class="btn btn-primary cs-autorizar">Autorizar</button>'}else{n="Deseja realmente salvar as alterações?";s="As informações anteriores serão perdidas.";o='<button type="button" data-id="'+e+'" data-pagina="'+t+'" class="btn btn-primary cs-editar-peca-lancamento">Editar</button>'}$(".modal-title").html(n);$(".modal-body").html(s);$(".modal-footer").html(o+'<button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>');$("#cs-modal").modal("show");$("#cs-modal .cs-editar-peca-lancamento").click(function(){var e=$("input[name=id-editar]").val();var t=$("input[name=descricao]").val();var n=$("input[name=marca]").val();var r=$("input[name=cor]").val();var i=$("input[name=tamanho]").val();var s=$("select[name=tipo]").find(":selected").val();if(t===""||n===""||r===""||s===""){alert_open("danger","Os campos com * são obrigatórios.")}else{if(s==="outro"){s=$("input[name=tipo_outro]").val()}$.ajax({type:"GET",url:"action/action_editar.php",dataType:"json",data:{action_pagina:"peca",action:"editar",action_id:e,descricao:t,marca:n,cor:r,tamanho:i,idtipo:s},success:function(e){if(e.erro===false){listar("entradapeca",1,15);alert_open("success","Peça editada com sucesso.");$("span#cs-div-pesquisa").show();$("span#cs-div-editar").hide();return true}else{return false;alert_open("danger",e.msg_erro)}},error:function(){return false;alert_open("danger","Erro inesperando, tente novamente mais tarde.")}})}$("#cs-modal").modal("hide")});$("#cs-modal .cs-autorizar").click(function(){if($("input[name=senha]").val()===""){alert_open("danger","O campo senha é obrigatório.")}else{$.ajax({type:"GET",url:"action/action_outros.php",dataType:"json",data:{action_pagina:"entradapeca",action:"logarusuario",senha:$("input[name=senha]").val()},success:function(r){if(r.erro===false){alert_open("success","Usuário autorizado a fazer alterações.");n="Deseja realmente salvar as alterações?";s="As informações anteriores serão perdidas.";o='<button type="button" data-id="'+e+'" data-pagina="'+t+'" class="btn btn-primary cs-editar-peca-lancamento">Editar</button>';$(".modal-title").html(n);$(".modal-body").html(s);$(".modal-footer").html(o+'<button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>');$("#cs-modal .cs-editar-peca-lancamento").click(function(){var e=$("input[name=id-editar]").val();var t=$("input[name=descricao]").val();var n=$("input[name=marca]").val();var r=$("input[name=cor]").val();var i=$("input[name=tamanho]").val();var s=$("select[name=tipo]").find(":selected").val();if(t===""||n===""||r===""||s===""){alert_open("danger","Os campos com * são obrigatórios.")}else{if(s==="outro"){s=$("input[name=tipo_outro]").val()}$.ajax({type:"GET",url:"action/action_editar.php",dataType:"json",data:{action_pagina:"peca",action:"editar",action_id:e,descricao:t,marca:n,cor:r,tamanho:i,idtipo:s},success:function(e){if(e.erro===false){listar("entradapeca",1,15);alert_open("success","Peça editada com sucesso.");$("span#cs-div-pesquisa").show();$("span#cs-div-editar").hide();return true}else{return false;alert_open("danger",e.msg_erro)}},error:function(){return false;alert_open("danger","Erro inesperando, tente novamente mais tarde.")}})}$("#cs-modal").modal("hide")})}else{alert_open("danger",r.msg_erro)}},error:function(){alert_open("danger","Erro inesperando, tente novamente mais tarde.")}})}})}else{alert_open("danger",r.msg_erro)}}})});$("#cs-modal").modal("hide")});$("button.cs-receber-peca").click(function(){listar("entradapeca",1,15);$("#cs-modal").modal("hide")});$("button.cs-devolver-peca").click(function(){listar("saidapeca",1,15);$("#cs-modal").modal("hide")});$("button.cs-conf-usuario-lancamento").click(function(){listar("visualizarlancamentousuario",1,10);$("#cs-modal").modal("hide")});$("button.cs-conf-usuario-ocorrencia").click(function(){listar("gerenciarocorrencia",1,10);$("#cs-modal").modal("hide")});$("button.cs-conf-usuario-cadastrar-ocorrencia").click(function(){listar("cadastrarocorrencia",1,10);$("#cs-modal").modal("hide")});$("#cs-modal .cs-bloquear").click(function(){$.ajax({type:"GET",url:"action/action_outros.php",dataType:"json",data:{action_pagina:"usuario-aluno",action:"bloquear",action_id:$(this).attr("data-id")},success:function(e){if(e.erro===false){alert_open("success","Aluno bloqueado com sucesso.");if(t==="usuario-aluno"){listar("usuario-aluno",1,10)}}else{alert_open("danger",e.msg_erro)}},error:function(){alert_open("danger","Erro inesperando, tente novamente mais tarde.")}});modal_open(e,t,n)});$("#cs-modal .cs-desbloquear").click(function(){$.ajax({type:"GET",url:"action/action_outros.php",dataType:"json",data:{action_pagina:"usuario-aluno",action:"desbloquear",action_id:$(this).attr("data-id")},success:function(e){if(e.erro===false){alert_open("success","Aluno desbloqueado com sucesso.");if(t==="usuario-aluno"){listar("usuario-aluno",1,10)}}else{alert_open("danger",e.msg_erro)}},error:function(){alert_open("danger","Erro inesperando, tente novamente mais tarde.")}});modal_open(e,t,n)});$("#cs-modal .cs-excluir-info").click(function(){n="";s="";o="";switch($(this).attr("data-pagina")){case"peca":n="Deseja realmente excluir a peça selecionada?";s="Não será possível recuperá-la.";o='<button type="button" data-id="'+e+'" data-pagina="'+t+'" class="btn btn-primary cs-excluir">Excluir</button>';break;case"entradapeca":$.ajax({type:"GET",url:"action/action_outros.php",dataType:"json",data:{action_pagina:"entradapeca",action:"pegarlogado"},success:function(i){if(i.erro===false){if(i.status===0){n="Digite a senha para autorização - Aluno";s='<form class="form-horizontal" role="form"><div class="form-group"><label class="col-sm-2 control-label">RA</label><div class="col-sm-10"><p class="form-control-static">'+i.usuario+'</p></div></div><div class="form-group"><label for="inputPassword" class="col-sm-2 control-label">Senha</label><div class="col-sm-10"><input type="password" name="senha" class="form-control" id="inputPassword" placeholder="Senha"></div></div></form>';o='<button type="button" class="btn btn-primary cs-autorizar">Autorizar</button>'}else{n="Deseja realmente remover  do lançamento a peça selecionada?";s="A peça será excluída apenas deste lancamento, ela continuará na lista de peças do aluno.";o='<button type="button" data-id="'+e+'" data-pagina="'+t+'" class="btn btn-primary cs-excluir">Remover</button>'}$(".modal-title").html(n);$(".modal-body").html(s);$(".modal-footer").html(o+u+'<button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>');$("#cs-modal .cs-voltar").click(function(){modal_open(e,t,r)});$("#cs-modal .cs-excluir").click(function(){excluir($(this).attr("data-pagina"),$(this).attr("data-id"));$("#cs-modal").modal("hide")});$("#cs-modal .cs-autorizar").click(function(){if($("input[name=senha]").val()===""){alert_open("danger","O campo senha é obrigatório.")}else{$.ajax({type:"GET",url:"action/action_outros.php",dataType:"json",data:{action_pagina:"entradapeca",action:"logarusuario",senha:$("input[name=senha]").val()},success:function(i){if(i.erro===false){alert_open("success","Usuário autorizado a fazer alterações.");n="Deseja realmente remover  do lançamento a peça selecionada?";s="A peça será excluída apenas deste lancamento, ela continuará na lista de peças do aluno.";o='<button type="button" data-id="'+e+'" data-pagina="'+t+'" class="btn btn-primary cs-excluir">Remover</button>';$(".modal-title").html(n);$(".modal-body").html(s);$(".modal-footer").html(o+u+'<button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>');$("#cs-modal .cs-voltar").click(function(){modal_open(e,t,r)});$("#cs-modal .cs-excluir").click(function(){excluir($(this).attr("data-pagina"),$(this).attr("data-id"));$("#cs-modal").modal("hide")})}else{alert_open("danger",i.msg_erro)}},error:function(){alert_open("danger","Erro inesperando, tente novamente mais tarde.")}})}})}else{alert_open("danger",i.msg_erro)}}});break;case"usuario-funcionario":n="Deseja realmente excluir o funcionario selecionado?";s="Não será possível recuperá-lo.";o='<button type="button" data-id="'+e+'" data-pagina="'+t+'" class="btn btn-primary cs-excluir">Excluir</button>';break;case"tipoocorrencia":n="Deseja realmente excluir o tipo de ocorrência selecionado?";s="Todas as ocorrências que possuem o tipo excluído também serão excluidas, e não será possível recuperá-las.";o='<button type="button" data-id="'+e+'" data-pagina="'+t+'" class="btn btn-primary cs-excluir">Excluir</button>';break;default:break}$(".modal-title").html(n);$(".modal-body").html(s);$(".modal-footer").html(o+u+'<button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>');$("#cs-modal .cs-voltar").click(function(){modal_open(e,t,r)});$("#cs-modal .cs-excluir").click(function(){excluir($(this).attr("data-pagina"),$(this).attr("data-id"));$("#cs-modal").modal("hide")})});$("#cs-modal .cs-editar").click(function(){pre_editar($(this).attr("data-pagina"),$(this).attr("data-id"));$("#cs-modal").modal("hide")});$("#cs-modal .cs-conf-alterar-num").click(function(){$.ajax({type:"GET",url:"action/action_listar.php",dataType:"json",data:{action_pagina:"numero",action:"listar",sexo:i[0].sexo},success:function(r){if(r.erro===false){var s=0;var o="";var a="";$.each(r,function(){s++});o+='<select name="novo_numero">';if(i[0].num!==""){o+='<option value="'+i[0].num+'">'+i[0].num+"<opition>"}else{o+='<option value="">Selecione<opition>'}for(var f=0;f<s-1;f++){o+='<option value="'+r[f].num+'">'+r[f].num+"<opition>"}o+="<select>";a='<button type="button" data-id="'+i[0].usuario+'" class="btn btn-success cs-alterar-num">Salvar</button>';$("#cs-num-aluno").html(o);$(".modal-footer").html(a+u+'<button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>');$("#cs-modal .cs-voltar").click(function(){modal_open(e,t,n)});$("#cs-modal .cs-alterar-num").click(function(){var r=$(this).attr("data-id");var i=$("select[name=novo_numero]").val();$.ajax({type:"GET",url:"action/action_editar.php",dataType:"json",data:{action_pagina:"numero",action:"editar",usuario:r,novo_numero:i},success:function(r){if(r.erro===false){modal_open(e,t,n);if(t==="usuario-aluno"){listar("usuario-aluno",1,10)}}}})})}}})})}else{alert_open("danger",i.msg_erro)}},error:function(){alert_open("danger","Erro ao abrir modal")}})}var caminho="http://localhost/acqua/";var locale=String(window.location.href);locale=locale.split("/");var pagina_url=locale[4];var action_id_local="";var tr_clicada="";switch(pagina_url){case"peca":listar("peca",1,10);carregar_select("peca");function cadastrar_peca(){var e=$("input[name=descricao]").val();var t=$("input[name=marca]").val();var n=$("input[name=cor]").val();var r=$("input[name=tamanho]").val();var i=$("select[name=tipo]").find(":selected").val();if(e===""||t===""||n===""||i===""){alert_open("danger","Os campos com * são obrigatórios.")}else{if(i==="outro"){i=$("input[name=tipo_outro]").val()}$.ajax({type:"GET",url:"action/action_cadastrar.php",dataType:"json",data:{action_pagina:"peca",action:"cadastrar",descricao:e,marca:t,cor:n,tamanho:r,idtipo:i},success:function(e){if(e.erro===false){listar("peca",1,10);alert_open("success","Cadastrada com sucesso.");$("#cs-form input").val("");$("#cs-form select").val("");$("div.cs-outro-form").hide()}else{alert_open("danger",e.msg_erro)}},error:function(e){alert_open("danger","Erro inesperando, tente novamente mais tarde.")}})}}function editar_peca(){var e=$("input[name=id-editar]").val();var t=$("input[name=descricao]").val();var n=$("input[name=marca]").val();var r=$("input[name=cor]").val();var i=$("input[name=tamanho]").val();var s=$("select[name=tipo]").find(":selected").val();if(t===""||n===""||r===""||s===""){alert_open("danger","Os campos com * são obrigatórios.")}else{if(s==="outro"){s=$("input[name=tipo_outro]").val()}$.ajax({type:"GET",url:"action/action_editar.php",dataType:"json",data:{action_pagina:"peca",action:"editar",action_id:e,descricao:t,marca:n,cor:r,tamanho:i,idtipo:s},success:function(e){if(e.erro===false){listar("peca",1,10);carregar_select("peca");alert_open("success","Peça editada com sucesso.");$("span#cs-action").html("Cadastrar");limpar_form_cadastro();return true}else{return false;alert_open("danger",e.msg_erro)}},error:function(){return false;alert_open("danger","Erro inesperando, tente novamente mais tarde.")}})}}break;case"ocorrencia":listar("ocorrencia",1,10);break;case"tipoocorrencia":listar("tipoocorrencia",1,10);function cadastrar_tipoocorrencia(){var e=$("input[name=tipo]").val();if(e===""){alert_open("danger","Todos os campos são obrigatórios.")}else{$.ajax({type:"GET",url:"action/action_cadastrar.php",dataType:"json",data:{action_pagina:"tipoocorrencia",action:"cadastrar",tipo:e},success:function(e){if(e.erro===false){listar("tipoocorrencia",1,10);alert_open("success","Cadastrado com sucesso.");$("#cs-form input").val("");$("#cs-form select").val("")}else{alert_open("danger",e.msg_erro)}},error:function(){alert_open("danger","Erro inesperando, tente novamente mais tarde.")}})}}function editar_tipoocorrencia(){var e=$("input[name=id-editar]").val();var t=$("input[name=tipo]").val();if(t===""){alert_open("danger","Todos os campos são obrigatórios.")}else{$.ajax({type:"GET",url:"action/action_editar.php",dataType:"json",data:{action_pagina:"tipoocorrencia",action:"editar",tipo:t,action_id:e},success:function(e){if(e.erro===false){listar("tipoocorrencia",1,10);alert_open("success","Editado com sucesso.");$("span#cs-action").html("Cadastrar");$("#cs-form input").val("");$("#cs-form select").val("")}else{alert_open("danger",e.msg_erro)}},error:function(){alert_open("danger","Erro inesperando, tente novamente mais tarde.")}})}}break;case"lancamento":$(document).ready(function(){$("#pecas-lancamento").multiSelect({selectableOptgroup:true,selectableHeader:"<div>Peças disponíveis para lavagem</div>",selectionHeader:"<div>Peças para Lavar - (<span id='qtd-pecas'>15</span> peças restantes)</div>",selectableFooter:"<div>Clique na descrição da peça para marcar</div>",selectionFooter:"<div>Clique na descrição da peça para remover da lavagem</div>",afterSelect:function(){verifica_qtd_marcados()},afterDeselect:function(){verifica_qtd_marcados()}});verifica_qtd_marcados()});function cadastrar_lancamento(){var e=$("#pecas-lancamento").val();if(e===null){alert_open("danger","Nenhuma peça marcada para o lançamento.")}else if(e.length>15){var t="";if(e.length-15>1){t="Você marcou "+e.length+" peças, o limite é de 15 peças, desmarque "+(e.length-15)+" peças para continuar."}else{t="Você marcou "+e.length+" peças, o limite é de 15 peças, desmarque "+(e.length-15)+" peça para continuar."}alert_open("danger",t)}else{alert_close("all");$.ajax({type:"GET",url:"action/action_cadastrar.php",dataType:"json",data:{action_pagina:"lancamento",action:"cadastrar",selecionadas:e},success:function(e){if(e.erro===false){alert_open("success","Lançamento efetuado com sucesso.")}else if(e.erro===true){alert_open("danger",e.msg_erro)}else{alert_open("success",e.msg_success)}},error:function(){alert_open("danger","Erro inesperando, tente novamente mais tarde.")}})}}function verifica_qtd_marcados(){var e=$("#pecas-lancamento").val();if(typeof e!=="undefined"){if(e!==null){var t=15-e.length;$("#qtd-pecas").html(t);if(e.length>15){var n="";if(e.length-15>1){n="Você marcou "+e.length+" peças, o limite é de 15 peças, desmarque "+(e.length-15)+" peças para continuar."}else{n="Você marcou "+e.length+" peças, o limite é de 15 peças, desmarque "+(e.length-15)+" peça para continuar."}alert_open("danger",n)}else{alert_close("all")}}else{alert_close("all");$("#qtd-pecas").html("15")}}}break;case"lancamentoativo":listar("lancamentoativo",1,15);break;case"lancamentospassados":listar("lancamentospassados",1,15);break;case"gerenciarocorrencia":action_id_local="";listar("gerenciarocorrencia",1,10);break;case"cadastrarocorrencia":action_id_local="";listar("cadastrarocorrencia",1,10);break;case"visualizarlancamento":action_id_local="";listar("visualizarlancamentousuario",1,10);break;case"usuario":listar("usuario-funcionario",1,10);function cadastrar_usuario_funcionario(){var e=$("input[name=email]").val();var t=$("input[name=usuario_nome]").val();var n=$("input[name=usuario_usuario]").val();var r=$("input[name=senha]").val();var i=$("input[name=repetirsenha]").val();var s=$("input[name=usuario_telefone]").val();var o=$("select[name=usuario_sexo]").find(":selected").val();var u=$("select[name=usuario_permissao]").find(":selected").val();if(t===""||n===""||u===""||o===""||e===""||r===""||i===""){alert_open("danger","Os campos com * são obrigatórios.")}else if(r!==i){alert_open("danger","Você deve digitar a mesma senha duas vezes.")}else{$.ajax({type:"GET",url:"action/action_cadastrar.php",dataType:"json",data:{action_pagina:"usuario-funcionario",action:"cadastrar",nome_usuario_cadastrar:t,usuario_usuario_cadastrar:n,sexo_usuario:o,email_usuario:e,senha:r,ramal_usuario_cadastrar:s,permissao_usuario_cadastrar:u},success:function(e){if(e.erro===false){listar("usuario-funcionario",1,10);alert_open("success","Cadastrado com sucesso.");$("#cs-form input").val("")}else{alert_open("danger",e.msg_erro)}},error:function(){alert_open("danger","Erro inesperando, tente novamente mais tarde.")}})}}function editar_usuario_funcionario(){var e=$("input[name=id-editar]").val();var t=$("input[name=email]").val();var n=$("input[name=usuario_nome]").val();var r=$("input[name=usuario_usuario]").val();var i=$("input[name=usuario_telefone]").val();var s=$("select[name=usuario_sexo]").find(":selected").val();var o=$("select[name=usuario_permissao]").find(":selected").val();if(n===""||r===""||o===""||s===""||t===""){alert_open("danger","Os campos com * são obrigatórios.")}else{$.ajax({type:"GET",url:"action/action_editar.php",dataType:"json",data:{action_pagina:"usuario-funcionario",action:"editar",action_id:e,nome_usuario:n,usuario_usuario:r,sexo_usuario:s,ramal_usuario:i,email_usuario:t,permissao_usuario:o},success:function(e){if(e.erro===false){listar("usuario-funcionario",1,10);$("span#cs-action").html("Cadastrar");alert_open("success","Usuário editado com sucesso.");limpar_form_cadastro()}else{alert_open("danger",e.msg_erro)}},error:function(e){alert_open("danger",e.msg_erro)}})}}break;case"numero":listar("numero_feminino",1,10);function cadastrar_numero(){var e=$("input[name=num_numero]").val();var t=$("select[name=num_sexo]").find(":selected").val();if(e===""||t===""){alert_open("danger","Todos campos são obrigatórios.")}else{$.ajax({type:"GET",url:"action/action_cadastrar.php",dataType:"json",data:{action_pagina:"numero",action:"cadastrar",num_numero:e,num_sexo:t},success:function(e){if(e.erro===false){if(t==="f"){if(!$(".cs-li-feminino").hasClass("active")){$(".cs-li-masculino").removeClass("active");$(".cs-li-feminino").addClass("active")}listar("numero_feminino",1,10)}else{if(!$(".cs-li-masculino").hasClass("active")){$(".cs-li-feminino").removeClass("active");$(".cs-li-masculino").addClass("active")}listar("numero_masculino",1,10)}alert_open("success","Cadastrado com sucesso.");$("#cs-form input").val("");$("#cs-form select").val("")}else{alert_open("danger",e.msg_erro)}},error:function(){alert_open("danger","Erro inesperando, tente novamente mais tarde.")}})}}break;case"atribuirnumero":listar("numero_feminino",1,10);function atribuir_numero_auto(){var e=$("select[name=num_sexo]").find(":selected").val();if(e===""){alert_open("danger","Todos campos são obrigatórios.")}else{$.ajax({type:"GET",url:"action/action_outros.php",dataType:"json",data:{action_pagina:"numero",action:"atribuir_numero_auto",sexo:e},success:function(t){if(t.erro===false){alert_open("success","Atribuído com sucesso.");$("#cs-form select").val("")}else{alert_open("danger",t.msg_erro)}if(e==="f"){if(!$(".cs-li-feminino").hasClass("active")){$(".cs-li-masculino").removeClass("active");$(".cs-li-feminino").addClass("active")}listar("numero_feminino",1,10)}else{if(!$(".cs-li-masculino").hasClass("active")){$(".cs-li-feminino").removeClass("active");$(".cs-li-masculino").addClass("active")}listar("numero_masculino",1,10)}},error:function(){alert_open("danger","Erro inesperando, tente novamente mais tarde.");if(e==="f"){if(!$(".cs-li-feminino").hasClass("active")){$(".cs-li-masculino").removeClass("active");$(".cs-li-feminino").addClass("active")}listar("numero_feminino",1,10)}else{if(!$(".cs-li-masculino").hasClass("active")){$(".cs-li-feminino").removeClass("active");$(".cs-li-masculino").addClass("active")}listar("numero_masculino",1,10)}}})}}break;default:break}$(document).ready(function(){$("div#cs-alert-success").hide();$("div#cs-alert-danger").hide();$("button.cs-btn-pesquisar-usuario").click(function(){if($(".cs-li-aluno").hasClass("active")){action_id_local=$("input[name=pesquisa]").val();if(action_id_local!==""){listar("usuario-aluno",1,10)}else{alert_open("danger","Campo pesquisa é obrigatório.")}}else if($(".cs-li-funcionario").hasClass("active")){action_id_local=$("input[name=pesquisa]").val();if(action_id_local!==""){listar("usuario-funcionario",1,10)}else{alert_open("danger","Campo pesquisa é obrigatório.")}}});$("button.cs-pesquisar").click(function(){var e=$("input[name=ra]").val();var t=$("input[name=numero]").val();if(e===""&&t===""){alert_open("danger","Digite RA ou Número.")}else if(e!==""){modal_open(e,$(this).attr("data-pagina"),"Detalhes do Aluno")}else{modal_open(t,$(this).attr("data-pagina"),"Detalhes do Aluno")}});$("#rm-lancamento").click(function(){excluir("lancamento",$(this).attr("data-id"));location.href=caminho+"lancamento"});$("#add-todos").click(function(){$("#pecas-lancamento").multiSelect("select_all")});$("#rm-todos").click(function(){$("#pecas-lancamento").multiSelect("deselect_all")});$("button.cs-cancelar").hide();$("button.cs-editar").hide();$("select[name=tipo]").change(function(){if($(this).val()==="outro"){$("div.cs-outro-form").show()}});$("a#cs-dataGrid-funcionario").click(function(){action_id_local="";listar("usuario-funcionario",1,10);$(".cs-li-aluno").removeClass("active");$(".cs-li-funcionario").addClass("active")});$("a#cs-dataGrid-aluno").click(function(){action_id_local="";listar("usuario-aluno",1,10);$(".cs-li-funcionario").removeClass("active");$(".cs-li-aluno").addClass("active")});$("a#cs-dataGrid-num-m").click(function(){listar("numero_masculino",1,10);$(".cs-li-feminino").removeClass("active");$(".cs-li-masculino").addClass("active")});$("a#cs-dataGrid-num-f").click(function(){listar("numero_feminino",1,10);$(".cs-li-masculino").removeClass("active");$(".cs-li-feminino").addClass("active")});$("button.cs-salvar").click(function(){switch($(this).attr("data-action")){case"cadastrar_peca":cadastrar_peca();break;case"cadastrar_lancamento":cadastrar_lancamento();break;case"cadastrar_idioma":cadastrar_idioma();break;case"cadastrar_usuario":cadastrar_usuario_funcionario();break;case"cadastrar_numero":cadastrar_numero();break;case"cadastrar_tipoocorrencia":cadastrar_tipoocorrencia();break;default:break}});$("button.cs-atribuir-auto").click(function(){atribuir_numero_auto()});$("button.cs-cancelar").click(function(){$("span#cs-action").html("Cadastrar");limpar_form_cadastro();if(pagina_url==="usuario"){$("div#senhas").show()}});$("button.cs-logar").click(function(){logar()});$("button.cs-limpar").click(function(){$("#cs-form input").val("");$("#cs-form select").val("")});$("button.close-success").click(function(){alert_close("success")});$("button.close-danger").click(function(){alert_close("danger")});$("a.cs-deslogar").click(function(){deslogar()});$("button.cs-alterar-senha").click(function(){var e=$("input[name=senha_atual]").val();var t=$("input[name=senha_nova]").val();var n=$("input[name=senha_nova_repetir]").val();if(e===""||t===""||n===""){alert_open("danger","Todos os campos são obrigatórios")}else if(t!==n){alert_open("danger","Você deve digitar a mesma senha duas vezes.")}else{$.ajax({type:"GET",url:"action/action_outros.php",dataType:"json",data:{action_pagina:"usuario",action:"alterar_senha",senha_atual:e,senha_nova:t},success:function(e){if(e.erro===false){$(".navbar-top-links input").val("");alert_open("success","Senha alterada com sucesso.")}else{alert_open("danger",e.msg_erro)}},error:function(){alert_open("danger","Erro inesperando, tente novamente mais tarde.")}})}});$("button.cs-esqueciasenha").click(function(){var e=$("input[name=usuario]").val();if(e===""){alert_open("danger","Digite o usuário.")}else{$.ajax({type:"GET",url:"action/esqueciasenha.php",dataType:"json",data:{usuario:e},success:function(e){if(e.erro===false){alert_open("success","Em instantes você receberá uma nova senha no e-mail "+e[0].email)}else{alert_open("danger",e.msg_erro)}},error:function(){alert_open("danger","Erro inesperando, tente novamente mais tarde.")}})}})})